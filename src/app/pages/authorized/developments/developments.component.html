<div class="developments-container">
    <!-- ✨ Usando variáveis do sistema: mb-48 ao invés de margin-bottom: 48px -->
    <h1 class="title-semibold primary-dark mb-48">Desenvolvimentos</h1>

    <!-- Barra de busca com espaçamento usando variáveis -->
    <div class="search-input">
        <div class="w-100">
            <ds-input [fullWidth]="true" label="Buscar" placeholder="Digite o nome do desenvolvimento, cliente, etc."
                [(ngModel)]="currentFilters.search" (ngModelChange)="onSearchChange()" icon="fa-solid fa-search"
                iconPosition="left" />
        </div>

        <div class="w-100">
            <ds-select label="Cliente" placeholder="Selecione o cliente" [(ngModel)]="currentFilters.status"
                (ngModelChange)="onSearchChange()" [options]="statusOption" [fullWidth]="true" />
        </div>

        <ds-button label="Novo desenvolvimento" icon="fa-solid fa-circle-plus" (onClickEmitter)="createDevelopment()" />
    </div>

    <div class="results mt-32">
        <ds-table emptyMessage="Nenhum desenvolvimento encontrado" *ngIf="shouldShowTable" [showPagination]="true"
            [pageSize]="currentFilters.limit" [totalPages]="pagination?.totalPages"
            [currentPage]="pagination?.currentPage || 1" (pageChanged)="onPageChange($event)"
            [loadingData]="shouldShowSpinner">

            <!-- Cabeçalho da tabela -->
            <ds-table-row [isHeader]="true">
                <ds-table-cell [isHeader]="true" align="left">Imagem</ds-table-cell>
                <ds-table-cell [isHeader]="true" align="left">Referência Interna</ds-table-cell>
                <ds-table-cell [isHeader]="true" align="left">Referência Cliente</ds-table-cell>
                <ds-table-cell [isHeader]="true" align="left">Variante</ds-table-cell>
                <ds-table-cell [isHeader]="true" align="left">Cliente</ds-table-cell>
                <ds-table-cell [isHeader]="true" align="left">Tipo Produção</ds-table-cell>
                <ds-table-cell [isHeader]="true" align="center">Status</ds-table-cell>
            </ds-table-row>

            <!-- ✨ DADOS DOS DESENVOLVIMENTOS -->
            <ds-table-row *ngFor="let development of developments" [clickable]="true" [data]="development"
                (rowClick)="onDevelopmentClick(development)">

                <!-- Imagem -->
                <ds-table-cell align="left">
                    <div class="image-cell">
                        <img *ngIf="development.pieceImage?.url; else noImage" [src]="development.pieceImage?.url"
                            [alt]="development.internalReference" class="development-image" />
                        <ng-template #noImage>
                            <div class="no-image-placeholder">
                                <i class="fa-solid fa-image"></i>
                            </div>
                        </ng-template>
                    </div>
                </ds-table-cell>

                <!-- Referência Interna -->
                <ds-table-cell align="left">
                    <span class="body secondary font-weight-medium">{{ development.internalReference }}</span>
                    <ds-icon (click)="copy($event, development.internalReference)" class="ml-4" cursorType="pointer"
                        icon="fa-regular fa-clipboard" fontSize="16px" />
                </ds-table-cell>

                <!-- Referência Cliente -->
                <ds-table-cell align="left">
                    <span class="body secondary">{{ development.clientReference || '-' }}</span>
                </ds-table-cell>

                <!-- Variante -->
                <ds-table-cell align="left">
                    <span class="body secondary">{{ development.variants || '-' }}</span>
                </ds-table-cell>

                <!-- Cliente -->
                <ds-table-cell align="left">
                    <div class="client-info">
                        <span class="body secondary">
                            {{ development.client?.companyName || 'Cliente não encontrado' }}
                        </span>
                        <div class="body-small label" *ngIf="development.client?.acronym">
                            {{ development.client?.acronym }}
                        </div>
                    </div>
                </ds-table-cell>

                <!-- Tipo Produção -->
                <ds-table-cell align="left">
                    <div class="production-types">
                        <span class="body secondary">
                            {{productionType(development.productionType!.type)}}
                        </span>
                    </div>
                </ds-table-cell>

                <!-- Status -->
                <ds-table-cell align="center">
                    <span class="body secondary">
                        {{ getStatusLabel(development.status) }}
                    </span>
                </ds-table-cell>

            </ds-table-row>
        </ds-table>
    </div>

    <!-- Modal de desenvolvimento -->
    <ds-modal modalId="development-modal" *ngIf="isModalOpen" (modalClosed)="onModalClosed($event)">
        <app-development-modal [developmentId]="selectedDevelopmentId"></app-development-modal>
    </ds-modal>

</div>